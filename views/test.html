<div class="content px-3">
    {{>navigation}}
    <div class="container mb-3">
        <div class="row">
            <div class="col left-col w-100 pe-0">
                <div class="issue-list-header container bg-white rounded-top border-bottom mt-3 py-3">
                    <div class="row container bg-white rounded pe-0">
                        <div class="col my-auto d-flex">
                            <span class="my-auto">Issues</span>
                            <div class="bg-danger-subtle px-2 mx-2 rounded">
                                <span class="text-danger">{{project.IssuesCount}}</span>
                            </div>
                        </div>
                        <div class="col d-flex justify-content-end pe-0">
                            <a href="#" class="mx-2 my-auto d-flex">
                                <i class="bi bi-share me-2"></i>
                                Share
                            </a>

                            <a href="#" class="mx-2 my-auto d-flex">
                                <img src="/images/report.png" alt=""
                                    style="margin: 0 0.5rem; width: 1.2rem; height: 1.2rem" />
                                Reports
                            </a>

                            <a href="/project/{{project.ProjectID}}/issue/import/" class="mx-2 my-auto d-flex">
                                <i class="bi bi-cloud-upload me-2"></i>
                                Import
                            </a>

                            <a href="/project/{{project.ProjectID}}/issue/export/" class="mx-2 my-auto d-flex">
                                <i class="bi bi-cloud-download me-2"></i>
                                Export
                            </a>

                            <button type="button" class="btn btn-danger mx-2 my-auto" style="width: 8rem"
                                data-bs-toggle="modal" data-bs-target="#addIssue"
                                data-projectid="{{project.ProjectID}}">
                                <i class="bi bi-plus"></i> Add Issue
                            </button>
                            <form action="" class="needs-validation" novalidate id="addIssueForm">
                                <input type="hidden" name="userId" value="{{user._id}}">
                                <div class="modal fade" id="addIssue" tabindex="-1"
                                    aria-labelledby="exampleModalFullscreenLabel" style="display: none"
                                    aria-hidden="true">
                                    <div class="modal-dialog modal-fullscreen">
                                        <div class="modal-content" style="margin-left: 300px; padding-right: 300px">
                                            <div class="modal-header">
                                                <div>
                                                    <h6 class="m-3">Add Issue</h6>
                                                    <ul class="nav nav-underline menu-2">
                                                        <li class="nav-item mx-2">
                                                            <a class="nav-link active border-danger" aria-current="page"
                                                                href="#">Details</a>
                                                        </li>
                                                        <li class="nav-item mx-2">
                                                            <a class="nav-link" href="#">Attachment</a>
                                                        </li>
                                                        <li class="nav-item mx-2">
                                                            <a class="nav-link" href="#">Custom Fields</a>
                                                        </li>
                                                        <li class="nav-item mx-2">
                                                            <a class="nav-link" href="#">Others</a>
                                                        </li>
                                                    </ul>
                                                </div>

                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body px-5">
                                                <div class="container">
                                                    <div class="row row-cols-md-2">
                                                        <div class="col mb-3">
                                                            <label for="fIssueTitle" class="form-label">Issue Title
                                                                <span class="text-danger">*</span></label>
                                                            <textarea class="form-control" id="fIssueTitle" rows="3"
                                                                name="issue-title" placeholder="Enter Issue Title"
                                                                required></textarea>
                                                            <div class="invalid-feedback">
                                                                Please Enter Issue Title.
                                                            </div>
                                                        </div>
                                                        <div class="col mb-3">
                                                            <label for="fIssueDescription"
                                                                class="form-label">Description</label>
                                                            <div class="rounded-top border d-flex p-2">
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-type-bold"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-type-italic"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-link"></i>
                                                                </button>
                                                                <form action="">
                                                                    <select class="form-select border-0"
                                                                        aria-label="Default select example"
                                                                        style="width: 8rem">
                                                                        <option selected>Normal</option>
                                                                        <option value="1">Small</option>
                                                                        <option value="2">Normal</option>
                                                                        <option value="3">Large</option>
                                                                    </select>
                                                                </form>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-list-ol"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-list-ul"></i>
                                                                </button>
                                                            </div>
                                                            <textarea class="form-control rounded-top-0"
                                                                id="fIssueDescription" rows="5" name="issue-description"
                                                                placeholder="Insert text here..."></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="row row-cols-md-2">
                                                        <div class="col mb-3">
                                                            <label for="fCategory" class="form-label">Category
                                                                <span class="text-danger">*</span></label>
                                                            <input class="form-control" list="datalistCategory"
                                                                id="fCategory" name="category"
                                                                placeholder="Select a Category" required />
                                                            <datalist id="datalistCategory">
                                                                {{#each project.Categories}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>

                                                            <div class="invalid-feedback">
                                                                Please Select a Category.
                                                            </div>
                                                        </div>
                                                        <div class="col mb-3">
                                                            <label for="fStatus" class="form-label">Status
                                                                <span class="text-danger">*</span></label>
                                                            <input class="form-control" list="datalistStatus"
                                                                id="fStatus" name="status" placeholder="Select a Status"
                                                                required />
                                                            <datalist id="datalistStatus">
                                                                {{#each project.Status}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>

                                                            <div class="invalid-feedback">
                                                                Please Select a Status.
                                                            </div>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fPriority" class="form-label">Priority
                                                                <span class="text-danger">*</span></label>
                                                            <input class="form-control" list="datalistPriority"
                                                                id="fPriority" name="priority"
                                                                placeholder="Select a Priority" required />
                                                            <datalist id="datalistPriority">
                                                                {{#each project.Priorities}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>

                                                            <div class="invalid-feedback">
                                                                Please Select a Priority.
                                                            </div>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fIssueType" class="form-label">Issue
                                                                Type</label>
                                                            <input class="form-control" list="datalistIssueType"
                                                                id="fIssueType" name="issue-type"
                                                                placeholder="Select a Issue Type" />
                                                            <datalist id="datalistIssueType">
                                                                {{#each project.BugTypes}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fAssignedTo" class="form-label">Assigned
                                                                To</label>
                                                            <input class="form-control" list="datalistAssignedTo"
                                                                id="fAssignedTo" name="assigned-to"
                                                                placeholder="Select an Assigned To" />
                                                            <datalist id="datalistAssignedTo">
                                                                {{#each project.Users}}
                                                                <option value="{{Name}}"></option>
                                                                {{/each}}
                                                            </datalist>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fTestRun" class="form-label">Test Run</label>
                                                            <input class="form-control" list="datalistTestRun"
                                                                id="fTestRun" name="testRun"
                                                                placeholder="Select a Test Run" />
                                                            <datalist id="datalistTestRun">
                                                                {{#each project.TestRuns}}
                                                                <option value="{{Name}}"></option>
                                                                {{/each}}
                                                            </datalist>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fSeverity" class="form-label">Severity</label>
                                                            <input class="form-control" list="datalistSeverity"
                                                                id="fSeverity" name="severity"
                                                                placeholder="Select a Severity" />
                                                            <datalist id="datalistSeverity">
                                                                {{#each project.Severities}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>
                                                        </div>

                                                        <div class="col mb-3">
                                                            <label for="fEnvironment" class="form-label">Environment
                                                            </label>
                                                            <input class="form-control" list="datalistEnvironment"
                                                                id="fEnvironment" name="environment"
                                                                placeholder="Select an Environment" />
                                                            <datalist id="datalistEnvironment">
                                                                {{#each project.Environments}}
                                                                <option value="{{this}}"></option>
                                                                {{/each}}
                                                            </datalist>
                                                        </div>

                                                        {{!-- <div class="col mb-3">
                                                            <label for="fRelease" class="form-label">Release</label>
                                                            <input class="form-control" list="datalistRelease"
                                                                id="fRelease" name="release"
                                                                placeholder="Select a Release" />
                                                            <datalist id="datalistRelease">
                                                                <option value="Web 7 ver 1.0"></option>
                                                            </datalist>
                                                        </div> --}}

                                                        {{!-- <div class="col mb-3">
                                                            <label for="fOperatingSystems" class="form-label">Operating
                                                                systems</label>
                                                            <input class="form-control" list="datalistOperatingSystems"
                                                                id="fOperatingSystems" name="operating-systems"
                                                                placeholder="Select Operating systems" />
                                                            <datalist id="datalistOperatingSystems">
                                                                <option value="All"></option>
                                                                <option value="Mac os"></option>
                                                                <option value="Ipad"></option>
                                                                <option value="Iphone"></option>
                                                                <option value="Android"></option>
                                                                <option value="Windows os"></option>
                                                            </datalist>
                                                        </div> --}}
                                                        <div class="col-2 mb-3">
                                                            <p class="mb-2">Due date</p>
                                                            <div class="row row-cols-md-2">
                                                                <div class="col d-flex">
                                                                    <label for="startDay"
                                                                        class="my-auto me-2">From</label>
                                                                    <input class="form-control" type="date"
                                                                        id="startDay" name="start-day" />
                                                                </div>
                                                                <div class="col d-flex">
                                                                    <label for="endDay" class="my-auto me-2">To</label>
                                                                    <input class="form-control" type="date" id="endDay"
                                                                        name="end-day" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row row-cols-md-2">
                                                        <div class="col mb-3">
                                                            <label for="fStepsToReproduce" class="form-label">Steps to
                                                                reproduce</label>
                                                            <div class="rounded-top border d-flex p-2">
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-type-bold"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-type-italic"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-link"></i>
                                                                </button>
                                                                <select class="form-select border-0"
                                                                    aria-label="Default select example"
                                                                    style="width: 8rem">
                                                                    <option selected>Normal</option>
                                                                    <option value="1">Small</option>
                                                                    <option value="2">Normal</option>
                                                                    <option value="3">Large</option>
                                                                </select>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-list-ol"></i>
                                                                </button>
                                                                <button type="button" class="bg-white border-0 mx-1">
                                                                    <i class="bi bi-list-ul"></i>
                                                                </button>
                                                            </div>
                                                            <textarea class="form-control rounded-top-0"
                                                                id="fStepsToReproduce" rows="5"
                                                                name="steps-to-reproduce"
                                                                placeholder="Insert text here..."></textarea>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <div class="right-side d-flex">
                                                    <button type="button" class="btn btn-outline-danger mx-2"
                                                        data-bs-dismiss="modal">
                                                        Cancel
                                                    </button>
                                                    <button type="submit" class="btn btn-danger mx-2">
                                                        Save
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>

                            <a href="#" class="guide mx-2 my-auto">
                                <div class="text-center">
                                    <img src="/images/guide.png" alt="" style="width: 2rem" />
                                    <br />
                                    <span>Guide</span>
                                </div>
                            </a>

                            <div class="d-flex">
                                <button type="button" class="btn btn-danger ms-2 my-auto rounded-end-0"
                                    style="width: 6rem">
                                    Classic
                                </button>
                                <button type="button" class="btn btn-outline-danger me-2 my-auto rounded-start-0"
                                    style="width: 6rem">
                                    Advanced
                                </button>
                            </div>
                            <a href="#" class="mx-2 my-auto" data-bs-toggle="tooltip" title="Actions"><img
                                    src="/images/9dots.png" alt="" style="width: 1.5rem; height: 1.5rem" /></a>
                        </div>
                    </div>
                </div>
                <div class="issue-list-body bg-white rounded-bottom">
                    <div class="above d-flex justify-content-between py-3 px-2">
                        <div class="w-25 d-flex">
                            {{!-- <span class="my-auto">Show</span>
                            <select class="form-select mx-2 my-auto" style="
                  background-color: #f5f5f5;
                  height: 2.5rem;
                  width: 6rem;
                  " aria-label="Default select example">
                                <option selected>10</option>
                                <option value="1">20</option>
                                <option value="2">30</option>
                                <option value="3">50</option>
                                <option value="3">100</option>
                            </select> --}}

                            <div class="d-flex">
                                <span class="my-auto">Sort</span>
                                <form action="" method="GET" class="mx-2 d-flex bg-white rounded" id="form-sort">
                                    <select name="sortField" class="form-select border-0 rounded-0 rounded-start"
                                        aria-label="Default select example" style="width: 10rem">
                                        <option value="created-date" {{#if (eq project.sortField 'created-date'
                                            )}}selected{{/if}}>Created date</option>
                                        <option value="title" {{#if (eq project.sortField 'title' )}}selected{{/if}}>
                                            Title</option>
                                        <option value="case-code" {{#if (eq project.sortField 'case-code'
                                            )}}selected{{/if}}>Code</option>
                                    </select>
                                    <select name="sortOrder" class="form-select border-0 rounded-0 ms-1 rounded-end"
                                        aria-label="Default select example" style="width: 7rem">
                                        <option value="desc" {{#if (eq project.sortOrder 'desc' )}}selected{{/if}}>Desc
                                        </option>
                                        <option value="asc" {{#if (eq project.sortOrder 'asc' )}}selected{{/if}}>Asc
                                        </option>
                                    </select>
                                </form>
                            </div>

                            <script>
                                document.addEventListener('DOMContentLoaded', function () {
                                    const sortForm = document.getElementById('form-sort');
                                    const sortFields = sortForm.querySelectorAll('select');

                                    sortFields.forEach(select => {
                                        select.addEventListener('change', function () {
                                            // Lấy URL hiện tại
                                            const currentUrl = new URL(window.location.href);

                                            // Lấy các tham số hiện tại từ URL
                                            const params = new URLSearchParams(currentUrl.search);

                                            // Cập nhật các tham số sắp xếp
                                            sortFields.forEach(field => {
                                                params.set(field.name, field.value);
                                            });

                                            // Tạo URL mới với các tham số đã cập nhật
                                            const newUrl = `${currentUrl.pathname}?${params.toString()}`;

                                            // Chuyển hướng đến URL mới
                                            window.location.href = newUrl;
                                        });
                                    });
                                });
                            </script>
                            <form action="" class="search-issueCode  mx-2">
                                <input type="text" class="form-control" placeholder="Search By Issues Code"
                                    aria-label="Recipient's username" aria-describedby="button-addon2"
                                    name="issueCodeKeyword" style="width: 12rem" />
                            </form>

                            <script>
                                document.addEventListener('DOMContentLoaded', function () {
                                    const form = document.querySelector('.search-issueCode');
                                    form.addEventListener('submit', function (event) {
                                        event.preventDefault();
                                        const keyword = document.querySelector('input[name="issueCodeKeyword"]').value;
                                        const currentUrl = new URL(window.location.href);
                                        currentUrl.searchParams.set('issueCodeKeyword', keyword);
                                        window.location.href = currentUrl.toString();
                                    });
                                });
                            </script>

                            <form action="" class="search-issueTitle  mx-2">
                                <input type="text" class="form-control" placeholder="Search By Issues Title"
                                    aria-label="Recipient's username" aria-describedby="button-addon2"
                                    name="issueTitleKeyword" style="width: 12rem" />
                            </form>

                            <script>
                                document.addEventListener('DOMContentLoaded', function () {
                                    const form = document.querySelector('.search-issueTitle');
                                    form.addEventListener('submit', function (event) {
                                        event.preventDefault();
                                        const keyword = document.querySelector('input[name="issueTitleKeyword"]').value;
                                        const currentUrl = new URL(window.location.href);
                                        currentUrl.searchParams.set('issueTitleKeyword', keyword);
                                        window.location.href = currentUrl.toString();
                                    });
                                });
                            </script>

                        </div>
                        <div class="d-flex my-auto justify-content-end">
                            {{!-- old --}}
                            {{!-- <button class="rounded-circle bg-dark-subtle d-flex mx-1 border-0"
                                style="width: 2rem; height: 2rem">
                                <i class="bi bi-chevron-compact-left m-auto"></i>
                            </button>
                            <button class="rounded-circle bg-danger d-flex mx-1 border-0"
                                style="width: 2rem; height: 2rem">
                                <span class="m-auto">1</span>
                            </button>
                            <button class="rounded-circle bg-dark-subtle d-flex mx-1 border-0"
                                style="width: 2rem; height: 2rem">
                                <i class="bi bi-chevron-compact-right m-auto"></i>
                            </button> --}}
                        </div>

                        {{!-- new --}}
                        <div class="d-flex my-auto justify-content-end">
                            {{{createPagination pagination paginationClass="pagination my-0"
                            paginationStyle="justify-content-end"
                            leftText="Prev" rightText="Next" }}}
                        </div>
                    </div>

                    <div class="below px-2 pb-2" style="">
                        <table class="table">
                            <thead>
                                <tr>
                                    <td scope="col" class="">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" value="" id="code"
                                                onchange="toggleCheckAllIssue(this)" />
                                            <label class="form-check-label" for="code">Code</label>
                                        </div>
                                    </td>
                                    <td scope="col" class="">Title</td>
                                    <td scope="col" class="">Created By</td>
                                    <td scope="col" class="">Assigned to</td>
                                    <td scope="col" class="">Status</td>
                                    <td scope="col" class="">Priority</td>
                                    <td scope="col" class="">Created Date</td>
                                    <td scope="col" class="">Actions</td>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each project.Issues}}
                                <tr>
                                    <td scope="col" class="align-middle">
                                        <div class="form-check">
                                            <input class="form-check-input code-issue-item" type="checkbox" value=""
                                                id="code-issue-item" data-issueId="{{this._id}}" />
                                            <label class="form-check-label" for="code-issue-item"><i
                                                    class="bi bi-bug me-1" style="color: orange"></i>{{truncateId
                                                this._id 8}}</label>
                                        </div>
                                    </td>
                                    <td scope="col" class="align-middle" style="max-width: 200px;">
                                        <a href="javascript:void(0);" class="issue-link-modal"
                                            onclick="navigateToIssue('{{../project.ProjectID}}', '{{this._id}}')"
                                            style="overflow-wrap: break-word; word-wrap: break-word; word-break: break-word;">{{this.Title}}</a>
                                        <script>
                                            function navigateToIssue(projectId, issueId) {
                                                // Get the current URL's query parameters
                                                const queryParams = new URLSearchParams(window.location.search);
                                                const queryString = queryParams.toString();

                                                // Construct the new URL
                                                let newUrl = `/project/${projectId}/issue/${issueId}`;
                                                if (queryString) {
                                                    newUrl += `?${queryString}`;
                                                }

                                                // Redirect to the new URL
                                                window.location.href = newUrl;
                                            }
                                        </script>
                                    </td>
                                    <td scope="col" class="align-middle">
                                        <div class="rounded-circle bg-primary bg-gradient d-flex text-white mt-2"
                                            style="width: 2rem; height: 2rem">
                                            <span class="m-auto">{{getInitials this.CreatedBy}}</span>
                                        </div>
                                    </td>
                                    <td scope="col" class="align-middle">{{this.AssignTo}}</td>
                                    <td scope="col" class="align-middle">
                                        <span>{{this.Status}}</span>
                                    </td>
                                    <td scope="col" class="align-middle">
                                        <span>{{this.Priority}}</span>
                                    </td>
                                    <td scope="col" class="align-middle">
                                        <span>{{formatDate3 this.CreatedAt}}</span>
                                    </td>
                                    <td scope="col" class="align-middle">
                                        <div class="d-flex">
                                            <a href="#" data-bs-toggle="tooltip" title="Timesheet"
                                                class="mx-2 my-auto"><i class="bi bi-clock"></i></a>
                                            <a data-bs-toggle="modal" data-bs-target="#editIssue" href="#"
                                                data-bs-toggle="tooltip" title="Edit" class="my-auto mx-2"
                                                data-id="{{this._id}}" data-title="{{this.Title}}"
                                                data-description="{{this.Description}}"
                                                data-category="{{this.Category}}" data-status="{{this.Status}}"
                                                data-priority="{{this.Priority}}" data-issue-type="{{this.IssueType}}"
                                                data-severity="{{this.Severity}}"
                                                data-environment="{{this.Environment}}"
                                                data-start-day="{{this.StartDate}}" data-end-day="{{this.EndDate}}"
                                                data-assign-to="{{this.AssignTo}}" data-test-run="{{this.TestRunName}}"
                                                data-steps-to-reproduce="{{this.StepsToReproduce}}">
                                                <i class="bi bi-pencil"></i>
                                            </a>


                                            <form action="" id="editIssueForm" class="needs-validation" novalidate>
                                                <input type="hidden" name="projectID" value="{{../project.ProjectID}}">
                                                <input type="hidden" name="issue-id" value="{{this._id}}">
                                                <div class="modal fade" id="editIssue" tabindex="-1"
                                                    aria-labelledby="exampleModalFullscreenLabel" style="display: none"
                                                    aria-hidden="true">
                                                    <div class="modal-dialog modal-fullscreen">
                                                        <div class="modal-content"
                                                            style="margin-left: 300px; padding-right: 300px">
                                                            <div class="modal-header">
                                                                <div>
                                                                    <h6 class="m-3">Edit Issue</h6>
                                                                    <ul class="nav nav-underline menu-2">
                                                                        <li class="nav-item mx-2">
                                                                            <a class="nav-link active border-danger"
                                                                                aria-current="page" href="#">Details</a>
                                                                        </li>
                                                                        <li class="nav-item mx-2">
                                                                            <a class="nav-link" href="#">Attachment</a>
                                                                        </li>
                                                                        <li class="nav-item mx-2">
                                                                            <a class="nav-link" href="#">Custom
                                                                                Fields</a>
                                                                        </li>
                                                                        <li class="nav-item mx-2">
                                                                            <a class="nav-link" href="#">Others</a>
                                                                        </li>
                                                                    </ul>
                                                                </div>

                                                                <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal" aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body px-5">
                                                                <div class="container">
                                                                    <div class="row row-cols-md-2">
                                                                        <div class="col mb-3">
                                                                            <label for="fIssueTitle"
                                                                                class="form-label">Issue Title
                                                                                <span
                                                                                    class="text-danger">*</span></label>
                                                                            <textarea class="form-control"
                                                                                id="fIssueTitle" rows="3"
                                                                                name="issue-title"
                                                                                placeholder="Enter Issue Title"
                                                                                required></textarea>
                                                                            <div class="invalid-feedback">
                                                                                Please Enter Issue Title.
                                                                            </div>
                                                                        </div>
                                                                        <div class="col mb-3">
                                                                            <label for="fIssueDescription"
                                                                                class="form-label">Description</label>
                                                                            <div class="rounded-top border d-flex p-2">
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-type-bold"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-type-italic"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-link"></i>
                                                                                </button>
                                                                                <form action="">
                                                                                    <select class="form-select border-0"
                                                                                        aria-label="Default select example"
                                                                                        style="width: 8rem">
                                                                                        <option selected>Normal</option>
                                                                                        <option value="1">Small</option>
                                                                                        <option value="2">Normal
                                                                                        </option>
                                                                                        <option value="3">Large</option>
                                                                                    </select>
                                                                                </form>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-list-ol"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-list-ul"></i>
                                                                                </button>
                                                                            </div>
                                                                            <textarea class="form-control rounded-top-0"
                                                                                id="fIssueDescription" rows="5"
                                                                                name="issue-description"
                                                                                placeholder="Insert text here..."></textarea>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row row-cols-md-2">
                                                                        <div class="col mb-3">
                                                                            <label for="fCategory"
                                                                                class="form-label">Category
                                                                                <span
                                                                                    class="text-danger">*</span></label>
                                                                            <input class="form-control"
                                                                                list="datalistCategory" id="fCategory"
                                                                                name="category"
                                                                                placeholder="Select a Category"
                                                                                required />
                                                                            <datalist id="datalistCategory">
                                                                                {{#each project.Categories}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>

                                                                            <div class="invalid-feedback">
                                                                                Please Select a Category.
                                                                            </div>
                                                                        </div>
                                                                        <div class="col mb-3">
                                                                            <label for="fStatus"
                                                                                class="form-label">Status
                                                                                <span
                                                                                    class="text-danger">*</span></label>
                                                                            <input class="form-control"
                                                                                list="datalistStatus" id="fStatus"
                                                                                name="status"
                                                                                placeholder="Select a Status"
                                                                                required />
                                                                            <datalist id="datalistStatus">
                                                                                {{#each project.Status}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>

                                                                            <div class="invalid-feedback">
                                                                                Please Select a Status.
                                                                            </div>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fPriority"
                                                                                class="form-label">Priority
                                                                                <span
                                                                                    class="text-danger">*</span></label>
                                                                            <input class="form-control"
                                                                                list="datalistPriority" id="fPriority"
                                                                                name="priority"
                                                                                placeholder="Select a Priority"
                                                                                required />
                                                                            <datalist id="datalistPriority">
                                                                                {{#each project.Priorities}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>

                                                                            <div class="invalid-feedback">
                                                                                Please Select a Priority.
                                                                            </div>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fIssueType"
                                                                                class="form-label">Issue
                                                                                Type</label>
                                                                            <input class="form-control"
                                                                                list="datalistIssueType" id="fIssueType"
                                                                                name="issue-type"
                                                                                placeholder="Select a Issue Type" />
                                                                            <datalist id="datalistIssueType">
                                                                                {{#each project.BugTypes}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fAssignedTo"
                                                                                class="form-label">Assigned
                                                                                To</label>
                                                                            <input class="form-control"
                                                                                list="datalistAssignedTo"
                                                                                id="fAssignedTo" name="assigned-to"
                                                                                placeholder="Select an Assigned To" />
                                                                            <datalist id="datalistAssignedTo">
                                                                                {{#each project.Users}}
                                                                                <option value="{{Name}}"></option>
                                                                                {{/each}}
                                                                            </datalist>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fTestRun"
                                                                                class="form-label">Test Run</label>
                                                                            <input class="form-control"
                                                                                list="datalistTestRun" id="fTestRun"
                                                                                name="testRun"
                                                                                placeholder="Select a Test Run" />
                                                                            <datalist id="datalistTestRun">
                                                                                {{#each project.TestRuns}}
                                                                                <option value="{{Name}}"></option>
                                                                                {{/each}}
                                                                            </datalist>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fSeverity"
                                                                                class="form-label">Severity</label>
                                                                            <input class="form-control"
                                                                                list="datalistSeverity" id="fSeverity"
                                                                                name="severity"
                                                                                placeholder="Select a Severity" />
                                                                            <datalist id="datalistSeverity">
                                                                                {{#each project.Severities}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>
                                                                        </div>

                                                                        <div class="col mb-3">
                                                                            <label for="fEnvironment"
                                                                                class="form-label">Environment
                                                                            </label>
                                                                            <input class="form-control"
                                                                                list="datalistEnvironment"
                                                                                id="fEnvironment" name="environment"
                                                                                placeholder="Select an Environment" />
                                                                            <datalist id="datalistEnvironment">
                                                                                {{#each project.Environments}}
                                                                                <option value="{{this}}"></option>
                                                                                {{/each}}
                                                                            </datalist>
                                                                        </div>

                                                                        <div class="col-2 mb-3">
                                                                            <p class="mb-2">Due date</p>
                                                                            <div class="row row-cols-md-2">
                                                                                <div class="col d-flex">
                                                                                    <label for="startDay"
                                                                                        class="my-auto me-2">From</label>
                                                                                    <input class="form-control"
                                                                                        type="date" id="startDay"
                                                                                        name="start-day" />
                                                                                </div>
                                                                                <div class="col d-flex">
                                                                                    <label for="endDay"
                                                                                        class="my-auto me-2">To</label>
                                                                                    <input class="form-control"
                                                                                        type="date" id="endDay"
                                                                                        name="end-day" />
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <div class="row row-cols-md-2">
                                                                        <div class="col mb-3">
                                                                            <label for="fStepsToReproduce"
                                                                                class="form-label">Steps to
                                                                                reproduce</label>
                                                                            <div class="rounded-top border d-flex p-2">
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-type-bold"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-type-italic"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-link"></i>
                                                                                </button>
                                                                                <select class="form-select border-0"
                                                                                    aria-label="Default select example"
                                                                                    style="width: 8rem">
                                                                                    <option selected>Normal</option>
                                                                                    <option value="1">Small</option>
                                                                                    <option value="2">Normal</option>
                                                                                    <option value="3">Large</option>
                                                                                </select>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-list-ol"></i>
                                                                                </button>
                                                                                <button type="button"
                                                                                    class="bg-white border-0 mx-1">
                                                                                    <i class="bi bi-list-ul"></i>
                                                                                </button>
                                                                            </div>
                                                                            <textarea class="form-control rounded-top-0"
                                                                                id="fStepsToReproduce" rows="5"
                                                                                name="steps-to-reproduce"
                                                                                placeholder="Insert text here..."></textarea>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <div class="right-side d-flex">
                                                                    <button type="button"
                                                                        class="btn btn-outline-danger mx-2"
                                                                        data-bs-dismiss="modal">
                                                                        Cancel
                                                                    </button>
                                                                    <button type="submit" class="btn btn-danger mx-2">
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>


                                            <a href="#" data-bs-toggle="tooltip" title="View" class="my-auto mx-2"><i
                                                    class="bi bi-eye"></i></a>
                                            <a href="#" data-bs-toggle="tooltip" title="Delete"
                                                class="mx-2 my-auto delete-issue" data-id="{{this._id}}"
                                                data-projectID="{{../project.ProjectID}}"><i
                                                    class="bi bi-trash"></i></a>


                                            <a href="#" data-bs-toggle="tooltip" title="Actions" class="mx-2 my-auto"><i
                                                    class="bi bi-three-dots-vertical"></i></a>

                                        </div>
                                    </td>
                                </tr>
                                {{/each}}

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-1 d-flex my-auto" style="margin-right: -0.5rem; z-index: 1000; width: 20px">
                <a href="#" id="toggleButtonFilter">
                    <div class="rounded bg-success d-flex text-white" style="width: 30px; height: 40px">
                        <i class="bi bi-chevron-compact-right m-auto" id="toggleIconFilter"></i>
                    </div>
                </a>
            </div>
            <div class="col-2 right-col filter-card mb-3">
                <div class="container rounded bg-white h-100 my-3 p-2">
                    <div>
                        <h6>Filter</h6>
                        <div class="d-flex justify-content-between border-bottom p-2">
                            <span>Filter</span>
                            <button class="border-0 bg-white btn-clear">Clear</button>
                        </div>
                        <div class="p-2">
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Category (<span class="num-category">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Categories}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input category-checkbox" type="checkbox"
                                                value="{{this}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{this}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}

                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Status (<span class="num-status">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Status}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input status-checkbox" type="checkbox"
                                                value="{{this}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{this}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}


                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Priority (<span class="num-priority">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Priorities}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input priority-checkbox" type="checkbox"
                                                value="{{this}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{this}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}

                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Bug Type (<span class="num-bug-type">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.BugTypes}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input bug-type-checkbox" type="checkbox"
                                                value="{{this}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{this}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}

                                </ul>
                            </div>

                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Assignee (<span class="num-assignee">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input assignee-checkbox" type="checkbox" value=""
                                                id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                Unassigned
                                            </label>
                                        </div>
                                    </li>
                                    {{#each project.UserAssigns}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input assignee-checkbox" type="checkbox"
                                                value="{{_id}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{Name}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}
                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Created By (<span class="num-created-by">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.UserCreates}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input created-by-checkbox" type="checkbox"
                                                value="{{_id}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{Name}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}
                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Environment (<span class="num-environment">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Environments}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input environment-checkbox" type="checkbox"
                                                value="{{this}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{this}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}

                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Release (<span class="num-release">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Releases}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input release-checkbox" type="checkbox"
                                                value="{{_id}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{Name}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}
                                </ul>
                            </div>
                            <div class="dropdown mb-2">
                                <button class="btn dropdown-toggleb btn-sm w-100 text-start bg-body-tertiary"
                                    type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    Module (<span class="num-module">0</span>)
                                </button>
                                <ul class="dropdown-menu px-2" aria-labelledby="dropdownMenuButton1">
                                    {{#each project.Modules}}
                                    <li>
                                        <div class="form-check">
                                            <input class="form-check-input module-checkbox" type="checkbox"
                                                value="{{_id}}" id="flexCheckDefault" />
                                            <label class="form-check-label" for="flexCheckDefault">
                                                {{Name}}
                                            </label>
                                        </div>
                                    </li>
                                    {{/each}}
                                </ul>
                            </div>
                        </div>
                        <div class="p-2">
                            <button type="button" class="btn btn-danger w-100" id="applyFilters">
                                Apply
                            </button>
                        </div>
                    </div>
                    <script>
                        function getCheckedValues(className) {
                            const checkboxes = document.querySelectorAll(`.${className}`);
                            let values = [];
                            checkboxes.forEach(checkbox => {
                                if (checkbox.checked) {
                                    values.push(checkbox.value);
                                }
                            });
                            return values.join(',');
                        }

                        document.getElementById('applyFilters').addEventListener('click', () => {
                            const category = getCheckedValues('category-checkbox');
                            const status = getCheckedValues('status-checkbox');
                            const priority = getCheckedValues('priority-checkbox');
                            const bugType = getCheckedValues('bug-type-checkbox');
                            const assignee = getCheckedValues('assignee-checkbox');
                            const createdBy = getCheckedValues('created-by-checkbox');
                            const environment = getCheckedValues('environment-checkbox');
                            const release = getCheckedValues('release-checkbox');
                            const module = getCheckedValues('module-checkbox');

                            let queryParams = [];
                            if (category) queryParams.push(`category=${category}`);
                            if (status) queryParams.push(`status=${status}`);
                            if (priority) queryParams.push(`priority=${priority}`);
                            if (bugType) queryParams.push(`bugType=${bugType}`);
                            if (assignee) queryParams.push(`assignee=${assignee}`);
                            if (createdBy) queryParams.push(`createdBy=${createdBy}`);
                            if (environment) queryParams.push(`environment=${environment}`);
                            if (release) queryParams.push(`release=${release}`);
                            if (module) queryParams.push(`module=${module}`);

                            const queryString = queryParams.join('&');
                            const currentUrl = window.location.href.split('?')[0]; // Lấy URL hiện tại mà không có query params
                            window.location.href = `${currentUrl}?${queryString}`;
                        });
                    </script>
                </div>
            </div>
        </div>
        <div class="container issue-bulk-action-cart shadow p-3 mb-5 bg-body rounded" style="display: none;">
            <form class="needs-validation" novalidate id="issueBulkActionsForm">
                <input type="hidden" name="projectId" value="{{project.ProjectID}}">
                <div class="bulk-header d-flex justify-content-between border-bottom pb-2">
                    <h5 class="">Bulk Actions</h5>
                    <button type="button" class="btn-close btn-close-bulk-action" aria-label="Close"></button>
                </div>
                <div class="bulk-body bg-body-secondary p-3 border-start">
                    <div class="mb-3">
                        <input class="form-control" list="datalistStatus1" id="fstatus" name="status"
                            placeholder="Select Status" />
                        <datalist id="datalistStatus1">
                            {{#each project.projectStatus}}
                            <option value="{{this}}"></option>
                            {{/each}}
                        </datalist>
                    </div>

                    <div class="mb-3">
                        <input class="form-control" list="datalistPriority" id="fPriority" name="priority"
                            placeholder="Select Priority" />
                        <datalist id="datalistPriority">
                            {{#each project.Priorities}}
                            <option value="{{this}}"></option>
                            {{/each}}
                        </datalist>
                    </div>

                    <div class="mb-3">
                        <input class="form-control" list="datalistIssueType" id="fIssueType" name="issueType"
                            placeholder="Select Issue Type" />
                        <datalist id="datalistIssueType">
                            {{#each project.BugTypes}}
                            <option value="{{this}}"></option>
                            {{/each}}
                        </datalist>
                    </div>


                    <div class="mb-3">
                        <input class="form-control" list="datalistAssignTo" id="fAssignTo" name="assignTo"
                            placeholder="Select an Assgined To" />
                        <datalist id="datalistAssignTo">
                            {{#each project.Users}}
                            <option value="{{this.Name}}"></option>
                            {{/each}}
                        </datalist>
                    </div>

                    <div class="mb-3">
                        <input class="form-control" list="datalistSeverity" id="fSeverity" name="severity"
                            placeholder="Select a Severity" />
                        <datalist id="datalistSeverity">
                            {{#each project.Severities}}
                            <option value="{{this}}"></option>
                            {{/each}}
                        </datalist>
                    </div>
                </div>
                <div class="bulk-footer d-flex justify-content-center border-top p-3">
                    <button type="button" class="btn btn-outline-danger mx-2 btn-close-bulk-action">
                        Cancel
                    </button>
                    <button type="submit" class="btn btn-danger mx-2">
                        Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>